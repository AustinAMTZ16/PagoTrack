import pyttsx3

# Configurar el motor de texto a voz
engine = pyttsx3.init()
engine.setProperty('rate', 160)  # Velocidad del habla
engine.setProperty('voice', 'spanish')  # Asegurar que se use una voz en español

# Texto mejorado para la grabación
texto_audio = """
    Análisis detallado de EAEPE SEPTIEMBRE 2024 CONAC.xlsx
1. Estructura de las hojas y contenido
El libro de Excel contiene varias hojas, cada una correspondiente a una clasificación distinta del Estado Analítico del Ejercicio del Presupuesto de Egresos (EAEPE) del Municipio de Puebla, para el periodo del 1° de enero al 30 de septiembre de 2024. A continuación se describe la estructura y contenido de cada hoja:
Portada: Es la hoja de presentación. Incluye el nombre "Municipio de Puebla", el título del reporte ("Estado Analítico del Ejercicio del Presupuesto de Egresos"), la clasificación que contiene (en este caso, todas las clasificaciones agregadas) y el periodo ("Del 01 de Enero al 30 de Septiembre de 2024"). Esta hoja está formateada como portada y no contiene datos numéricos ni cálculos; los textos parecen estar en celdas combinadas o cuadros de texto, ya que no se leen fácilmente con herramientas de datos tradicionales.
Clas Admva (Clasificación Administrativa): Presenta la distribución del gasto según la estructura orgánica o administrativa. La primera columna muestra códigos jerárquicos y nombres de los entes/sectores. Por ejemplo, se enumeran niveles como 3 Sector Público Municipal, luego 3.1 Sector Público No Financiero, 3.1.1 Gobierno General Municipal, etc., hasta niveles específicos del municipio. Finalmente aparecen las dependencias municipales con su nombre (p.ej., "Coordinación de las Regidurías", "Oficina de la Presidencia Municipal", "Secretaría del Ayuntamiento", etc.). Las columnas B a G muestran cifras de presupuesto en distintas etapas: Aprobado (1), Ampliaciones/(Reducciones) (2), Modificado (3 = 1+2), Devengado (4), Pagado (5) y Subejercicio (6 = 3-4). Estas últimas se calculan como la diferencia entre modificado y devengado. En la parte inferior hay una fila "Total del Gasto" que resume el total de egresos administrativos (debe coincidir con el total general). Además, esta hoja incluye, a la derecha, una tabla que originalmente es una tabla dinámica (o un volcado de ella) con el desglose por dependencia administrativa: aparece la etiqueta "Etiquetas de fila" y columnas "Suma de Original", "Suma de Ampliaciones - Reducciones", "Suma de Modificado", "Suma de Devengado Contable", "Suma de Pagado" (y posiblemente "Suma de Subejercicio"). En dicha tabla se listan códigos y nombres de dependencias (por ejemplo "301 COORDINACION DE LAS REGIDURIAS", "302 OFICINA DE LA PRESIDENCIA MUNICIPAL", etc.) con las mismas cifras de presupuesto, confirmando los valores de la clasificación administrativa. En resumen, la hoja combina una lista jerárquica por sector y dependencia (izquierda) con un desglose detallado por dependencia (derecha).
Clasif cap con del gasto (Clasificación por Objeto del Gasto - Capítulo y Concepto): Esta hoja muestra el ejercicio del presupuesto clasificado por capítulos y conceptos de gasto (de acuerdo con el clasificador por objeto del gasto del CONAC). La columna A contiene códigos de capítulo y concepto combinados con sus descripciones. Por ejemplo, 1000-Servicios Personales en un nivel superior, seguido de desgloses como 1100-Remuneraciones al Personal Permanente, 1200-... Transitorio, 1300-Remuneraciones Adicionales, etc., que suman el capítulo 1000. De igual forma se listan 2000-Materiales y Suministros (con sus conceptos 2100, 2200, etc.), 3000-Servicios Generales, 4000, 5000, etc., hasta 9000. Las columnas B a G nuevamente representan Aprobado, Ampliaciones/(Reducciones), Modificado, Devengado, Pagado y Subejercicio, respectivamente. Los valores de capítulo (por ejemplo, la fila de 1000-Servicios Personales) son la suma de sus conceptos específicos. Al final de la hoja (fila "Total del Gasto") se muestra el total sumando todos los capítulos. En la misma hoja, a partir de cierta columna a la derecha, se ve otra tabla estilo dinámica con la etiqueta "Etiquetas de fila" y columnas "Suma de Original", "Suma de Ampliaciones - Reducciones", etc., donde se listan nuevamente los códigos de capítulo-concepto (aparecen en mayúsculas, e.g., "1000-SERVICIOS PERSONALES" y sus conceptos análogos) con los mismos valores. Esto sugiere que al lado derecho se dispuso una tabla dinámica (o valores de ella) que agrupa los datos por el mismo criterio de objeto del gasto, sirviendo para verificar las sumas.
Clasif eco tipo de gasto (Clasificación Económica por tipo de gasto): Esta hoja organiza el gasto según categorías económicas amplias: típicamente Gasto Corriente, Gasto de Capital, Amortización de la Deuda, Pensiones y Jubilaciones, Participaciones, etc. En efecto, la columna A contiene estos conceptos; por ejemplo, "Gasto Corriente", "Gasto de Capital", "Amortización de la Deuda y Disminución de Pasivos", "Pensiones y Jubilaciones", y "Participaciones". Las columnas B-G nuevamente reflejan las etapas del presupuesto (Aprobado, Modificado, etc. y Subejercicio). Al final hay un Total del Gasto que suma todas estas categorías económicas (debería equivaler al total general del ejercicio). A la derecha, también se incluyó una sección que parece provenir de una tabla dinámica: en este caso, bajo "Etiquetas de fila" se muestran códigos numéricos (1, 2, 3, 4, … que probablemente corresponden a cada tipo de gasto) y las columnas de sumas (Original, Ampliaciones, etc.). Por ejemplo, el código 1 se alinea con Gasto Corriente, 2 con Gasto de Capital, etc., y en la fila de Total general de la tabla dinámica aparecen los totales globales. Así, esta hoja confronta la vista por tipo de gasto con una tabla de verificación por código.
Funcional (Clasificación Funcional – Finalidad y Función): Contiene el desglose del gasto por clasificación funcional (finalidades, funciones, subfunciones si aplicara). La columna A lista las finalidades y funciones según el clasificador funcional. Es de esperar algo como "0 Administración General", "1 Desarrollo Social", "2 Desarrollo Económico", "3 Otras no clasificadas" u otras finalidades y, anidadas, las funciones específicas (por ejemplo, dentro de Desarrollo Social: Educación, Salud, Asistencia Social, etc.). Cada nivel suma a su superior. Las columnas B-G son nuevamente las etapas presupuestales y el subejercicio. Al lado derecho, se observa otra tabla estilo dinámica con Etiquetas de fila y columnas de Suma de... que muy probablemente enumeran los códigos numéricos de finalidad/función y sus sumas, o listan las funciones en mayúsculas. Al final hay una fila de Total del Gasto que resume el total funcional, debiendo coincidir con las otras hojas.
Programático (Gasto por Categoría Programática): Nota: Existen dos hojas casi con el mismo nombre, diferenciadas solo por un espacio adicional en el nombre (Programático vs Programático ). Esto sugiere que una puede ser una versión anterior o duplicada. Efectivamente, la primera Programático parece contener datos de “Del 01 de Enero al 30 de Junio de 2022” (según el encabezado en la fila de periodo), lo que indica que es un artefacto desactualizado. La segunda hoja Programático (la actualizada, con el periodo hasta septiembre 2024) contiene la clasificación programática vigente. En esta descripción nos enfocaremos en la hoja correspondiente a 2024. La clasificación programática se organiza por categorías de programas presupuestarios identificados con letras (según la estructura CONAC). Por ejemplo, en la columna A se observan entradas como "Programas" (un encabezado general), luego "Subsidios: Sector Social y Privado o Entidades Federativas y Municipios" con subcategorías S y U (Sujetos a Reglas de Operación / Otros Subsidios), luego "Desempeño de las Funciones" con varias letras debajo, etc. Específicamente, bajo Desempeño de las Funciones aparecen categorías identificadas con letras: E – Prestación de Servicios Públicos, B – Provisión de Bienes Públicos, P – Planeación, Seguimiento y Evaluación de Políticas, F – Promoción y Fomento, G – Regulación y Supervisión, A – Funciones de las Fuerzas Armadas (esta última aplica solo a nivel federal, por eso figura pero con valores 0), R – Específicos, K – Proyectos de Inversión. Más adelante hay otros grupos: "Administrativos y de Apoyo" que agrupa categorías M, O, W (de las cuales O - Apoyo a la función pública... tiene valores, mientras M y W están en 0), "Compromisos" que agrupa L (Obligaciones de resolución jurisdiccional) y N (Desastres Naturales), ambos sin monto en este periodo, y "Obligaciones" que agrupa J, T, Y, Z (todas en 0, relacionadas con pensiones, aportaciones, etc. que en el municipio no tienen asignación). También se incluye "Programas de Gasto Federalizado (Gobierno Federal)" con categorías I, C, D, H que igualmente están en 0 (ya que son rubros federales no ejercidos por el municipio). Cada grupo principal tiene su fila de total (calculada sumando sus categorías hijas) y la hoja tiene al final el Total del Gasto programático. Las columnas B-G mantienen el significado (Aprobado, Ampliaciones, Modificado, Devengado, Pagado, Subejercicio). En la parte derecha de esta hoja también hay un área de tabla dinámica o sus valores: en ella, bajo "Etiquetas de fila", aparecen las letras de programa (E, B, P, F, G, A, R, K, O, etc., incluyendo 'Total general'), y en las columnas de la tabla las sumas correspondientes de Original, Modificado, etc. Por ejemplo, en la fila donde A="E - Prestación de Servicios Públicos" con sus números, en la sección de la tabla dinámica se ve la letra E y las mismas cifras, confirmando la correspondencia. Notablemente, en la hoja programática de 2024, el texto de periodo está correcto (Septiembre 2024), mientras que en la hoja duplicada (2022) no se actualizó ese texto. Esto indica que la segunda hoja es la versión actualizada y la primera quedó como rezago.
NOTAS: Esta hoja reúne las “notas aclaratorias”. En la práctica, contiene encabezados similares a la portada (Municipio de Puebla, Tesorería Municipal, “Notas aclaratorias”, el título del conjunto de estados analíticos y el periodo al 30 de Sept 2024). Luego, en una celda combinada, lista los tipos de clasificación incluidos: “Clasificación Administrativa, Clasificación Económica (Por Tipo de Gasto), Clasificación por Objeto del Gasto, Clasificación Funcional, Clasificación Programática”. Sin embargo, más allá de enumerar estas clasificaciones, no se observan textos explicativos adicionales ni celdas con notas detalladas debajo. Parece más un espacio preparado para eventualmente detallar notas o aclaraciones metodológicas, pero actualmente sin contenido explicativo específico (posiblemente solo espacios en blanco después del listado). En resumen, la hoja NOTAS está estructurada para describir las cinco vistas (coincidiendo con las hojas anteriores) pero carece de información desarrollada más allá de los títulos.
En general, cada hoja (salvo Portada y Notas) sigue un patrón estructural común: filas de encabezados en la parte superior (en dos niveles, uno para los títulos generales de columnas y otro para los subíndices o fórmulas de cálculo), luego filas de datos jerárquicos en la parte izquierda (códigos/nombres de categorías y subcategorías con sus valores en distintas etapas presupuestales), y a la derecha de esas, una sección de tabla dinámica (o equivalente) con Etiquetas de fila (que suelen ser códigos o nombres repetidos de las categorías) y las Sumas de las mismas etapas presupuestales, funcionando como un espejo o verificación. Cada hoja termina con una fila Total del Gasto, que representa el total consolidado de esa clasificación (debe ser igual en todas las clasificaciones, reflejando el mismo monto total de presupuesto ejercido).
2. Uso de fórmulas, cálculos y transformaciones en las celdas
El archivo utiliza numerosas fórmulas para calcular valores agregados, diferencias y para enlazar datos entre secciones (principalmente entre la parte “manual”/jerárquica y la parte de tabla dinámica en la misma hoja). A continuación se detallan los tipos principales de fórmulas identificadas y cómo están construidas:
Suma de subtotales jerárquicos: En cada clasificación, los niveles superiores se calculan sumando sus componentes. Por ejemplo, en la hoja de Clasificación por Objeto del Gasto, la celda correspondiente al capítulo 1000-Servicios Personales (fila 11, columna B en ese caso) no es un dato ingresado directamente sino la suma de las celdas de sus conceptos 1100, 1200, ..., 1700. La fórmula en B11 es =SUM(B12:B18), sumando los montos aprobados de las partidas bajo 1000. De igual manera, D11 (modificado del capítulo 1000) es =SUM(D12:D18), y E11 (devengado) es =SUM(E12:E18), etc. En otras hojas, en lugar de la función SUMA, a veces se suman explícitamente dos celdas si solo hay dos componentes. Por ejemplo, en la hoja Clas Admva, la categoría 3.1.1.1.0 Gobierno Municipal (fila 13) suma dos partes: =B14+B33 (suma del Órgano Ejecutivo Municipal y de Entidades Paraestatales) para obtener el total de ese nivel. Así, la estructura jerárquica se construye con fórmulas de agregación que aseguran que cada total de nivel superior siempre refleje la suma actualizada de sus hijos.
Cálculo de “Modificado” (3) como Aprobado + Ampliaciones/(Reducciones): En muchos casos, las columnas de Modificado (3) no son valores ingresados manualmente, sino calculados a partir de las columnas 1 y 2. Por ejemplo, en Clasificación Económica, la celda D11 para Gasto Corriente tiene la fórmula =B11 + C11, de modo que Modificado = Aprobado + (Ampliaciones o Reducciones). Este patrón se repite para cada partida o categoría base: cada fila al nivel más bajo suele tener Modificado calculado sumando las celdas de la misma fila de Aprobado y Ampliaciones/Reducciones. En niveles agregados, el valor modificado a veces también se obtiene por suma de sub-niveles (como mencionamos antes) en lugar de recalcular B+C (ambas formas dan el mismo resultado si las sumas están bien estructuradas).
Cálculo del Subejercicio (6) como Modificado - Devengado: La columna Subejercicio (6 = 3-4) representa la diferencia entre el presupuesto modificado y el devengado (lo no ejercido del crédito presupuestal modificado). En los niveles más detallados, cada celda de subejercicio normalmente tiene una fórmula de resta. Por ejemplo, en la hoja de Objeto del Gasto, la celda G12 (subejercicio para el concepto 1100) es =D12 - E12, restando el devengado al modificado de esa línea. En niveles superiores, suelen optar por sumar los subejercicios de las componentes, lo que equivale matemáticamente a la misma resta a nivel agregado. Por ejemplo, G11 = SUM(G12:G18) suma los subejercicios de los conceptos para obtener el subejercicio del capítulo 1000 (lo cual coincide con D11 - E11). En Clas Admva, donde la jerarquía es variada, también se aplican fórmulas de resta similares. Es decir, en cada hoja, la columna de subejercicio está poblada enteramente por fórmulas (ya sea resta directa o suma de restas de niveles inferiores).
Vinculación entre filas adyacentes (celdas que replican valores): Se observó en la hoja de Clasificación Administrativa que algunas celdas simplemente referencian la de abajo, creando una especie de “cadena”. Por ejemplo, en Clas Admva, la fila 10 (Sector Público Municipal) tiene celdas con fórmulas como =B11 en B10, =C11 en C10, ... hasta =G11 en G10. A su vez, la fila 11 (Sector Público No Financiero) referenciaba la fila 12 de forma similar (B11 = B12, C11 = C12, etc.). Esto indica que como solo existe un subnivel (3.1) bajo el 3, y un solo subnivel (3.1.1) bajo 3.1, en lugar de usar SUMA para agregar (que en este caso sería redundante), optaron por enlazar directamente el valor del único hijo. Es una práctica algo inusual (podrían simplemente haber mostrado la misma cifra), pero la intención puede ser mantener la estructura flexible para futuros cambios: si en algún momento existieran varias filas bajo Sector Público Municipal, la fórmula se adaptaría a sumar en lugar de una referencia directa. En todo caso, estas referencias directas B10 = B11, B11 = B12, etc., facilitan que todos los niveles superiores reflejen exactamente el valor del único componente cuando la jerarquía tiene ramas únicas.
Suma de totales de secciones dispersas: En algunas hojas, la fila Total del Gasto final se calcula sumando múltiples rangos no contiguos, en lugar de un simple rango continuo, porque la estructura jerárquica puede tener saltos. Por ejemplo, en Clasif. por Objeto del Gasto, la fórmula del total (fila 83, col B) es =B11+B19+B29+...+B75, enumerando explícitamente la celda de total de cada capítulo (1000, 2000, 3000, ..., 9000)【22†】. Esto se debe a que entre esos renglones hay muchas filas de detalle, por lo que no se puede usar una única SUMA continua sin incluir indebidamente datos de niveles inferiores. Enumerando solo los totales de cada capítulo se asegura que el Total general sea la suma de cada categoría principal. Este patrón aparece en todas las hojas donde distintas categorías principales no son contiguas: se suman explícitamente cada una.
Fórmulas de verificación entre la sección izquierda y derecha (tabla dinámica): Un aspecto notable es la presencia de fórmulas que comparan valores de la tabla izquierda (la clasificación propiamente dicha) con los de la tabla dinámica de la derecha, para garantizar que coinciden. Por ejemplo, en Clas Admva, hay fórmulas como =E14 - M14 en alguna celda, cuyo resultado esperado es 0. Aquí E14 es el Devengado del Órgano Ejecutivo Municipal (Ayuntamiento) en la sección izquierda, y M14 es el Devengado Contable sumado de esa misma entidad en la sección de tabla dinámica. Restarlos verifica si hay discrepancia. De igual manera, hay fórmulas de la forma =J14 + J33 en Clas Admva, que suman ciertos valores de la tabla dinámica (en este caso, podría ser sumando el Original de Órgano Ejecutivo Municipal con el de Entidades Paraestatales) y seguramente comparándolo con otra celda para comprobar la consistencia con un total. En varias hojas se identificaron fórmulas como:
L31 - D31, L38 - D38, etc., típicamente comparando el Modificado sumado por la dinámica (columna L, "Suma de Modificado") contra el Modificado de la clasificación (columna D) en ciertos renglones de total intermedio o total final.
M71 - E71 análogo para Devengado.
O57 - G57 para Subejercicio (asumiendo que la tabla dinámica también calculó el subejercicio en columna O). Estas fórmulas de diferencia sirven para resaltar si hubiera alguna diferencia entre los dos enfoques. Idealmente, todos esos resultados deben ser cero (lo que indicaría consistencia perfecta). Es una técnica de control interno dentro del archivo: cada vez que se actualizan datos, estas fórmulas inmediatamente mostrarían un valor no-cero si algo quedó descuadrado entre el total de la izquierda y la suma detallada de la derecha. En la práctica, al inspeccionar los valores, efectivamente todos estos cálculos dan cero o un valor despreciable (diferencias de redondeo muy pequeñas) — lo cual confirma que las cifras coinciden. Por ejemplo, en Clasif. Administrativa, E14 = 5,432,717,598.49 y M14 = 5,432,717,598.49, entonces E14 - M14 = 0. Del mismo modo, en Objeto del Gasto, para el capítulo 3000 en cierta fila, L38 y D38 son ambos 129,694,570.93 (aprox.), resultando la fórmula L38 - D38 ≈ 0. Estas fórmulas de chequeo están esparcidas en distintos puntos clave (como totales de grupo y totales generales).
Observación sobre fórmulas de la tabla dinámica: Dado que en la versión actual del archivo la tabla dinámica parece haber sido copiada como valores (ver siguiente sección), las fórmulas de diferencia están usando valores estáticos a la derecha. No obstante, originalmente, si la tabla dinámica estuviera activa, no existirían fórmulas en las celdas de la tabla dinámica (serían resultados propios de la pivot). Por tanto, todas las fórmulas descritas en este punto están en la sección izquierda o en columnas auxiliares, no dentro de la pivot (excepto que posiblemente hayan añadido alguna columna manual junto a la pivot para la diferencia). En los datos examinados, no vimos referencias cruzadas con nombres de hoja ni fórmulas externas, lo cual implica que todos los cálculos se realizan dentro de cada hoja con sus propias celdas; no hay, por ejemplo, una fórmula en Clasificación Funcional que apunte a un resultado de Clasificación Administrativa, lo cual tiene sentido porque cada una es autosuficiente pero se espera que converjan a los mismos totales.
En resumen, el archivo utiliza fórmulas principalmente para: (a) sumar componentes en las jerarquías, (b) calcular campos derivados (modificado, subejercicio) de acuerdo a definiciones, (c) replicar datos únicos para mantener estructura, y (d) verificar la consistencia entre diferentes representaciones de los mismos datos. Esto sugiere que el autor del archivo quería asegurarse de no cometer errores de dedo al ingresar totales, dejando que Excel realice las agregaciones y comprobaciones automáticamente.
3. Construcción de las tablas dinámicas: estructura, campos y origen de datos
En cada hoja de clasificación (Administrativa, Objeto del Gasto, Económica, Funcional y Programática) se incluyó una tabla dinámica (pivot table) o al menos una copia de sus resultados, que sirve para mostrar el desglose de los datos según un criterio determinado y facilitar comparaciones con la clasificación principal. Aunque en la versión proporcionada del archivo las tablas dinámicas pudieran estar desvinculadas (p.ej., pegadas como valores) – de hecho, en los metadatos internos no se encontraron definiciones activas de pivote – la disposición de los datos revela claramente la huella de dichas pivots. A continuación describimos cómo están estructuradas esas tablas dinámicas, qué campos utilizan y cómo parecen haber sido configuradas:
Estructura general de las tablas dinámicas: En todas aparece una columna de "Etiquetas de fila" (que es el encabezado genérico que Excel da a la columna donde van las categorías de fila del pivot). Debajo de esa, se listan los elementos de la dimensión elegida para filas, y a la derecha se muestran columnas con el prefijo "Suma de ..." seguido del nombre de algún campo de valores. En este caso, las tablas muestran hasta 5 o 6 columnas de valores que corresponden a los montos presupuestales: Original (Aprobado), Ampliaciones/Reducciones, Modificado, Devengado Contable, Pagado, y en algunos casos Subejercicio. Cada uno de estos es un campo de valor sumado en la tabla dinámica. No se aprecian campos en la posición de "Columna" de la pivot (todas las columnas son esas métricas de suma), ni campos de filtro en la visualización (podría haber filtros aplicados internamente, pero no se ven en el volcado). La tabla dinámica, por tanto, está configurada para resumir el dataset completo según una variable categórica (que corresponde a la clasificación de la hoja).
Hoja Clasificación Administrativa (Clas Admva) – Pivot por Dependencia: La tabla dinámica en esta hoja está desglosando el presupuesto por cada unidad administrativa/dependencia municipal. Es decir, el campo colocado en Etiquetas de fila es el identificador de la dependencia. En los datos vemos códigos como 301, 302, 303,... acompañados del nombre de cada dependencia, por ejemplo "301 COORDINACION DE LAS REGIDURIAS", "302 OFICINA DE LA PRESIDENCIA MUNICIPAL", etc., listados uno debajo de otro. Esto sugiere que la fuente de datos de la pivot tenía un campo "Clave de Dependencia" o "Nombre de Dependencia" que se usó para agrupar. Es probable que ese campo ya concatenara código y nombre, o bien la tabla dinámica se configuró para mostrar ambos (Excel permite mostrar ambos si uno lo formatea, pero aquí aparecen juntos en una celda, lo que hace pensar que en la fuente estaban unidos). No se observa otra jerarquía dentro de la pivot (por ejemplo, Organos superiores) listada; más bien, la pivot parece listar directamente cada dependencia como fila independiente, ordenadas por su código (301, 302, 303, ... en orden ascendente). Campos de valores: Son cinco o seis sumas: Suma de Original (que equivale al Aprobado inicial), Suma de Ampliaciones - Reducciones, Suma de Modificado, Suma de Devengado Contable, Suma de Pagado, y posiblemente Suma de Subejercicio (aunque en la visualización de esta hoja no vimos explícito "Suma de Subejercicio" en el encabezado, es muy probable que se haya calculado también). Origen de datos: Debe ser una tabla de datos detallados del presupuesto por partidas y dependencias. Dado que no hay una hoja con esos datos, es posible que la pivot estuviera alimentada de un rango oculto o de un origen externo (otra base o archivo) antes de pegar los valores. Los nombres de los campos (Original, Ampliaciones, etc.) sugieren que el origen tenía columnas con esos nombres. La pivot probablemente no tenía filtros de reporte activos para esta hoja, ya que muestra todas las dependencias; sin embargo, el diseño del reporte coloca manualmente los grupos de organo (como Órgano Ejecutivo vs Entidades Paraestatales) en la sección izquierda. Es posible que originalmente la tabla dinámica estuviera filtrada por órgano para presentar primero un bloque (e.g., solo las dependencias del Órgano Ejecutivo Municipal), luego otra pivot separada para las entidades paramunicipales. Pero dado que en los datos vemos la pivot continua con códigos 301... hasta los de Organismos (DIF, etc.), parecería que dejaron la pivot sin filtros y luego acomodaron visualmente al lado izquierdo los títulos para separar esos bloques (por ejemplo, la fila "Órgano Ejecutivo Municipal (Ayuntamiento)" en la izquierda coincide con el rango de dependencias 301-...-305 debajo; luego más abajo, la fila "Entidades Paraestatales..." en la izquierda coincide con el inicio de los códigos de organismos paramunicipales en la pivot). En conclusión, la pivot administrativa agrupa todos los registros presupuestarios por dependencia y muestra los totales de cada una en las distintas métricas.
Hoja Clasificación por Objeto del Gasto – Pivot por Objeto (Capítulo/Concepto): En la parte derecha de esta hoja, la pivot muestra entradas como "1000-SERVICIOS PERSONALES", "1100-REMUNERACIONES AL PERSONAL DE CARÁCTER PERMANENTE", etc., en mayúsculas. Esto indica que se usaron como filas los códigos de objeto del gasto, probablemente hasta el nivel de concepto (4 dígitos). Observamos que tanto los códigos de capítulo (p.ej. 1000, 2000) como los códigos de concepto (1100, 1200, etc.) aparecen en la lista de la pivot. Esto sugiere dos posibles configuraciones: (1) La tabla dinámica incluía dos campos en filas – el capítulo y el concepto – de modo que crea una jerarquía. Sin embargo, normalmente en una pivot jerárquica Excel mostraría las celdas de capítulo en una fila y las de concepto indentadas debajo sin repetir el código del capítulo en cada fila. Aquí vemos que 1000 y 1100...1700 aparecen todos enumerados con su texto completo, uno tras otro. Es posible que habilitaran la opción “Repetir etiquetas de elemento” en la tabla dinámica, que rellena las etiquetas de categoría padre en cada fila de los hijos. Así, 1000-SERVICIOS PERSONALES aparecería en la fila total del capítulo y también repetido en cada línea de concepto debajo, junto con 1100-..., etc. Alternativamente, (2) el origen de datos tenía una columna combinada "Código-Descripción" para cada partida de gasto, sin separar capítulo y concepto, y simplemente se incluyó esa columna como única etiqueta de fila. En tal caso, la pivot enumeraría cada valor único de esa columna; eso incluiría los registros con código 1000 (que quizás representan sumas por capítulo en la base de datos) y los registros con código 1100, etc. La primera opción (capítulo y concepto separados en la pivot) es más acorde a un análisis, pero la repetición de etiquetas nos hace pensar que optaron por la segunda: podrían haber agrupado los datos a nivel de cada código ya en la fuente y la pivot simplemente los suma (lo que haría que 1000 no fuera suma de 1100s dentro de la pivot, sino un registro aparte, lo cual sería extraño conceptualmente). Dado que los totales sí cuadran bien jerárquicamente, probablemente la pivot estaba configurada jerárquicamente y se repetían etiquetas. Campos de valores: igual que la anterior – sumas de original, ampliaciones, etc., hasta pagado (y posiblemente subejercicio). Filtro/origen: Sin ver la pivot original es difícil afirmarlo, pero probablemente no había filtros, incluía todos los capítulos y conceptos existentes en el dataset. El origen de datos sería la lista de transacciones o asignaciones presupuestarias con su código de objeto del gasto; la pivot agrupa por ese código. Cabe señalar que se aseguraron de formatear la pivot para que los nombres aparezcan en mayúsculas en la tabla dinámica (quizás el origen ya estaba en mayúsculas) y en la izquierda en formato normal con mayúsculas/minúsculas tal como figura en el clasificador oficial. Esto hace más fácil distinguir visualmente la sección de la pivot (que está en mayúsculas sostenidas) de la sección izquierda.
Hoja Clasificación Económica – Pivot por Tipo de Gasto: En la sección dinámica de esta hoja, bajo Etiquetas de fila vimos números 1, 2, 3, 4, etc., correspondidos por los conceptos de Gasto Corriente, Capital, etc. Esto indica que la pivot estaba agrupando por el código numérico de tipo de gasto. Es probable que la base de datos tenga un campo, por ejemplo "TipoGastoCodigo" = {1,2,3,4,5} y otro "TipoGastoNombre". En la pivot parecen haber puesto solo el código (o tal vez código+nombre, pero solo mostró el código), lo cual es algo curioso ya que para un informe uno preferiría ver la descripción. De hecho, en la parte izquierda, pusieron manualmente los nombres ("Gasto Corriente", "Gasto de Capital", etc.), y en la pivot se ve solo el número correspondiente en la columna de etiquetas. En la fila final de la pivot aparece "Total general", que es el rótulo de total de la tabla dinámica en español, con los totales de cada campo. Campos de valor: de nuevo las sumas de original, ampliaciones, modificado, devengado, pagado, subejercicio. Filtros: Probablemente ninguno, ya que incluye todos los tipos (1 a 5) que suman el total. Observamos que la fila de "Participaciones" tenía todos ceros en la izquierda y no apareció un código "5" en la pivot (aparece 1,2,3,4, luego total general, pero no un 5). Es posible que Excel omitiera de la pivot mostrar categorías cuyo valor total es cero (hay una opción para eso), o que no hubiera registros de tipo 5 en la base de datos. En cualquier caso, la pivot económica confirma los totales de Corriente, Capital, etc., pero los nombres fueron añadidos en la izquierda para claridad. Es posible que la pivot original tuviera tanto código como nombre en filas (dos niveles: primero quizás una categoría amplia Corriente vs Capital vs Otros, aunque aquí es directamente 1-5), pero más probable es que usaron solo código para poder hacer la verificación numérica, asumiendo que quien consulte verá la descripción en la izquierda.
Hoja Funcional – Pivot por Función (y posiblemente Finalidad): Aunque no extrajimos explícitamente los códigos de la pivot funcional, por analogía, la estructura sugiere que la tabla dinámica agrupó los datos por la clave de función o finalidad+función. En la lista de notas de la hoja NOTAS se menciona “Finalidad y Función”, lo que indica que la clasificación funcional se compone de esos dos niveles. Es posible que la pivot tuviera ambas: por ejemplo Finalidad 1, 2, 3 en filas de primer nivel, y dentro de cada una las funciones específicas como 11, 12, 13... Sin embargo, según la salida de fórmulas que vimos, aparecen referencias a celdas L29 - D29, L38 - D38 en esa hoja, posiblemente comparando totales de ciertas finalidades. Esto sugiere que p.ej. fila 29 y 38 eran totales de bloques en la izquierda. Si la pivot tuviera dos niveles, es probable que también repitieran etiquetas para cada combinación. Sin datos textuales directos, asumiremos que la pivot funcional tenía como Etiquetas de fila algún identificador (tal vez la combinación código-nombre de función). De la consistencia de datos, podemos inferir que la pivot sí contenía los mismos totales que la izquierda. Campos de valor: los mismos (Original, etc.). Posible filtro: Es improbable que filtraran algo aquí; deberían estar todas las finalidades que suman el total. La tabla dinámica probablemente listaba las finalidades y funciones con indentación, o quizá solo funciones con un código complejo. En cualquier caso, su propósito es nuevamente duplicar la información por ese eje de clasificación.
Hoja Programática – Pivot por Categoría Programática: La pivot programática presenta letras (E, P, F, G, etc.) en la columna de etiquetas de fila, lo que indica que se agruparon los datos por el código de categoría programática. En este caso, afortunadamente las letras por sí mismas tienen significado (cada letra corresponde a una categoría de programas). En la porción que extrajimos, se vio por ejemplo O alineado con la fila "O - Apoyo a la función pública y al mejoramiento de la gestión" y mostrando los valores. Igualmente R para Específicos, P para Planeación..., etc. Se aprecia también un "Total general" al final de la pivot con los totales. Parece que la pivot programática solo usó un campo (la letra de categoría) como fila, listando todos las categorías que tienen datos. Jerarquía vs grupos: Notemos que en la clasificación programática oficial, esas letras se agrupan en categorías mayores (como vimos: Subsidios incluye S y U, Desempeño de las Funciones incluye E, B, P, F, G, A, R, K, etc., Administrativos y Apoyo incluye M, O, W, etc., Compromisos incluye L, N, Obligaciones incluye J, T, Y, Z, y Programas de Gasto Fed incluye I, C, D, H). La pivot aparentemente no reflejó estos agrupamientos, sino que listó cada código individual de forma plana. Por ejemplo, O aparece separado; la pivot no sabe que O y M y W pertenecen juntas, eso lo manejaron en la sección izquierda sumándolos y poniendo un título. Entonces, es probable que no se incluyeron campos de fila adicionales en la pivot para grupo programático; simplemente un campo para la letra/categoría. Campos de valor: los de siempre (sumas de las métricas). Filtro: Es posible que excluyeran de la pivot categorías totalmente vacías para no mostrarlas (de nuevo, opción de "omitir elementos sin datos"), aunque en la pivot vemos incluso categorías que resultaron 0 tenían filas en la izquierda (ejemplo, A, K, etc., que eran 0 – no está claro si la pivot mostró esas; puede que no y que las agregaran manualmente a la izquierda por completar el formato, o que la pivot las mostrara con 0). Dado que letras como A, K figuran en la izquierda pero no vimos en la pivot recorte, es muy posible que la pivot haya excluido automáticamente los ceros. En cualquier caso, la pivot programática sirvió para validar que, por ejemplo, la suma de todos los programas tipo E es X millones, la de P es Y millones, etc., y que la suma de esos (los que tienen datos) coincide con el total programático.
Origen de los datos para las tablas dinámicas: Aunque el libro no muestra directamente la base de datos, podemos inferir qué contenía. Mínimamente, el conjunto de datos fuente debía tener campos para: Dependencia (administrativa), Clave de objeto del gasto, Tipo de gasto, Función, Programa, y montos asociados (Original, Ampliaciones, Devengado, etc.) para cada unidad de clasificación. Esto podría ser, por ejemplo, una tabla de presupuesto por partida contable donde cada registro tiene todas esas dimensiones clasificatorias y los importes. Las tablas dinámicas luego agrupan esa base según la dimensión deseada. El hecho de que todas las clasificaciones presenten exactamente los mismos valores totales (p.ej., el total del gasto pagado es 5,571,271,591.34 en todas) indica que efectivamente provienen de una misma fuente común; es decir, no son hojas aisladas con datos inconexos, sino distintas vistas del mismo universo de datos. Es probable que el origen haya sido un sistema de contabilidad o de presupuesto (posiblemente los reportes del CONAC para el municipio), exportado y luego procesado en Excel. Puede que el autor haya copiado/pegado valores de las pivots finales en cada hoja para compartir el informe sin necesidad de adjuntar la base de datos. Al hacerlo, quedaron como evidencia los rótulos típicos de pivot (Etiquetas de fila, Total general, Suma de X). Esto ayuda a entender la construcción original, aunque en el estado actual del archivo, las “tablas dinámicas” ya no son interactivas sino estáticas.
Configuración de campos calculados: Un detalle es la presencia (o ausencia) del campo Subejercicio en las pivots. Dado que Subejercicio (6) es un cálculo (3-4), Excel no lo sumaría automáticamente a menos que se definiera como campo calculado en la tabla dinámica. No observamos explícitamente el texto "Suma de Subejercicio" en los encabezados visibles, pero las fórmulas de comprobación hacen referencia a columna O en varias hojas, lo que coincide con donde estaría Subejercicio si estuviera incluido. Es probable que se haya creado en cada pivot un campo calculado definido como [Modificado] - [Devengado Contable], para que apareciera también la suma de subejercicio por categoría, facilitando la comparación. Alternativamente, pudieron calcular la diferencia fuera de la pivot (como columna adicional con fórmulas) pero es más limpio hacerlo dentro de la pivot. Si efectivamente estaba, el encabezado quizás quedó oculto o sobrescrito por la etiqueta de subejercicio de la izquierda. En Clas Admva, por ejemplo, la columna O de la sección dinámica muy probablemente contenía ese cálculo (pues la fórmula G31 - O31 sugeriría Subejercicio izq. vs Subejercicio der.). Entonces, asumimos que en la configuración original de cada tabla dinámica se añadieron todos los campos de valores directos (Original, Amp/Red, Modificado, Devengado, Pagado) y un campo calculado de Subejercicio (6). Este último campo sumaría las diferencias por grupo (lo cual es válido porque la suma de (Modificado-Devengado) por grupo = (Suma de Modificado - Suma de Devengado) del grupo, que coincide con el subejercicio agregado).
Ordenamiento y formato: Las pivots parecen ordenadas por los códigos lógicos de cada clasificación (no alfabéticamente por nombre). Ejemplo: pivot administrativa por número de dependencia; pivot objeto por orden de código 1000,1100,...; pivot económica por el código 1,2,3...; pivot programática por letra (que en el alfabeto coincidentemente ordena E, F, G..., pero en el listado específico notamos que el orden fue E, B, P, F, G, A, R, K, O,... — esto en realidad no sigue el alfabeto ni exactamente el orden del manual programático, lo cual puede ser el orden en que existen datos en la base; habría que revisar). Posiblemente el orden de la pivot programática fue personalizado para mostrar primero las letras con datos en grupos lógicos (E, B, P, F, G, A, R, K corresponden al grupo "Desempeño de las Funciones" mezclado con A y K insertados en su posición alfabética, luego O de otro grupo, etc.). Es posible que después de pegar los valores hayan ordenado manualmente esas filas. Sin la pivot activa es difícil confirmarlo, pero en general los listados parecen coherentes.
En síntesis, las tablas dinámicas fueron diseñadas como una forma de recalcular los totales por cada clasificación de manera independiente, usando la misma base de datos. Esto proporciona una verificación interna: si todos los totales concuerdan, significa que los datos se integraron bien. Los campos en uso siempre incluyen la dimensión correspondiente a la clasificación de la hoja como fila, ningún campo como columna, todos los campos monetarios como valores (con función SUMA), y posiblemente uno calculado. Los filtros aplicados parecen mínimos o nulos; las pivots cubren todo el conjunto de datos, salvo que para presentación hayan ocultado categorías sin movimientos. El origen de datos subyacente no está directamente visible, pero se deduce que es común y consistente para todas las vistas (lo que redunda en la confiabilidad del análisis transversal).
4. Calidad y consistencia de la información ingresada
En términos de calidad de datos, el archivo en general muestra consistencia numérica y estructural, aunque también se detectan algunos detalles que podrían mejorarse o que destacan como posibles errores u omisiones. Evaluemos varios aspectos: exactitud de cálculos, coherencia entre hojas, formatos, celdas vacías o repetidas, y potenciales equivocaciones:
Consistencia numérica entre clasificaciones: Un punto positivo es que todas las clasificaciones cuadran el mismo total de gasto. El Total del Gasto en cada hoja es idéntico (cuando se expande a todas las cifras decimales). Por ejemplo, el Total de Egresos Modificado es 7,869,226,147.83 y el Devengado 6,085,911,765.80 en todas las hojas (Administrativa, Objeto, Económica, Funcional, Programática). Las fórmulas de verificación internas (como las mencionadas restas pivot vs izquierda) confirman casi todos 0. Los pequeños residuos que vimos (del orden de 1e-06) son debidos al manejo de decimales en computadora, pero en cifras monetarias redondeadas son cero. Esto indica que no hay errores aritméticos evidentes ni omisiones de partidas entre las distintas vistas: la información es internamente consistente.
Exactitud de los cálculos de fórmulas: Al revisar varias celdas calculadas aleatoriamente, se encontró que las sumas y restas concuerdan correctamente con los valores base. No hay indicios de errores en las fórmulas (como rangos mal extendidos o referencias equivocadas). Por ejemplo, la suma de servicios personales (1000) efectivamente iguala la suma de 1100-1700; el subejercicio calculado concuerda con modificado menos devengado en cada caso. Esta consistencia sugiere que se puso cuidado en construir bien las fórmulas.
Celdas vacías y separadores: Hay celdas vacías que se usan principalmente para formato. Por ejemplo, a menudo la columna H está en blanco para separar visualmente la sección izquierda de la tabla dinámica derecha. También hay filas vacías o casi vacías (por ejemplo, fila 10 en Programático solo dice "Programas" y luego nada más en ese renglón de datos; o filas 16, 20, 27, 30 en Programático que contienen títulos de grupo con 0 en todo). Estas celdas vacías no representan datos perdidos sino que son parte de la estructura de reporte para espaciados o títulos de sección. No se hallaron celdas que debiesen tener un valor pero que estén vacías sin explicación; cada categoría sin monto simplemente aparece con 0 en las columnas financieras (lo cual es correcto en contexto presupuestario, por ejemplo, Funciones de las Fuerzas Armadas para un municipio es lógicamente 0).
Manejo de valores cero: Relacionado con lo anterior, se ingresaron ceros explícitos para todas aquellas categorías no aplicables. Por ejemplo, en Programático, muchas categorías (A, K, S, U, etc.) están llenas de 0 en Aprobado, Modificado, etc. Esto homogeniza el cuadro y evita celdas verdaderamente vacías en medio de datos numéricos, lo cual es correcto desde el punto de vista de consistencia (aunque mostrar filas enteras de ceros podría considerarse ruido, el informe las incluye por exhaustividad). No se detectaron valores "NA" ni errores de tipo (#¡REF!, #¡DIV/0!, etc.); solo ceros o celdas en blanco por formato.
Formato de textos y etiquetas: La mayoría de los textos siguen un formato consistente (por ejemplo, nombres de partidas con mayúscula inicial, códigos seguidos de guión y nombre). Sin embargo, hay pequeñas inconsistencias/errores tipográficos:
En Clasificación Programática, una de las categorías tiene el código en minúscula: "l - Obligaciones de cumplimiento de resolución jurisdiccional" (debería ser "L - ..."). Esa letra minúscula probablemente es un error de dedo. Dado que todas las demás categorías se listan con su letra mayúscula, esta sobresale. No afecta cálculos (ya que igualmente tenía valor 0), pero es un detalle de calidad de texto.
Los nombres de las hojas tienen espacios extra: por ejemplo "Portada " con dos espacios al final, "Programático " repetida. Esto es menor, pero puede causar confusión al referirse a ellas o al programar contra el archivo. Idealmente los nombres de pestaña no deberían llevar espacios sobrantes ni duplicarse.
En la hoja Programático duplicada, el encabezado de período no fue actualizado (dice "Del 01 de Enero al 30 de Junio 2022" en lugar de 2024). Esto claramente parece un descuido: la hoja original de 2022 fue copiada para 2024 y se modificaron los datos numéricos pero no ese texto. Como resultado, en el informe 2024 hay una hoja (la primera Programático) con título de periodo incorrecto. Esto podría inducir a error a quien lo lea sin notar la diferencia de espacios en el nombre de la pestaña. Es un problema de calidad de la información descriptiva.
En la hoja NOTAS, el bloque de texto con las clasificaciones muestra nombres consistentes, aunque por alguna razón ocupa una celda muy grande llena de espacios hasta la derecha (posiblemente para centrado). Se nota que hay espacios en blanco en esa celda (fila 12) después de listar Programática, quizá por formato. Esto no causa un problema grave, solo estético (puede verse como una celda tremendamente ancha si no se ajusta el ancho correctamente).
Duplication de información y hojas obsoletas: La presencia de la hoja Programático duplicada (una versión antigua con datos en cero o desactualizados) merma la calidad del documento final. Tener dos hojas con el mismo nombre conceptual puede confundir al usuario. Además, los datos de esa hoja antigua (primer semestre 2022) no corresponden al periodo indicado en el título del archivo (septiembre 2024). Esto parece claramente una omisión de limpieza del archivo. La hoja duplicada no aporta nada al análisis 2024 y podría llevar a interpretaciones equivocadas si alguien la revisa pensando que es parte del informe actual. Idealmente, esa hoja debería eliminarse o actualizarse completamente para mantener consistencia temporal en el libro.
Integridad de la estructura jerárquica: Analizando la Clasificación Administrativa, se advierte un ligero enredo conceptual: la forma en que se sumaron ciertas filas podría inducir duplicación si no se tiene cuidado, aunque en este caso los totales quedaron correctos. En concreto, se listan "3.1.1.1.0 Gobierno Municipal" y "3.1.1.2.0 Entidades Paraestatales..." como dos ramas distintas bajo "3.1.1 Gobierno General Municipal". Normalmente, uno esperaría que Gobierno General Municipal sumase ambas. En la hoja, sin embargo, la celda de 3.1.1 Gobierno General (B12) está definida como =B13, es decir, toma solo el valor de Gobierno Municipal y no suma Entidades【15†】. En cambio, la fila 3.1.1.1.0 Gobierno Municipal (B13) fue definida como =B14 + B33【13†】, donde B33 es la suma de Entidades Paraestatales. Es decir, metieron el aporte de las entidades dentro de la cifra de Gobierno Municipal. Esto es inusual, porque conceptualmente Gobierno Municipal no debería incluir a los organismos descentralizados (estos van por separado aunque ambos suman Gobierno General). A pesar de eso, el Total del Gasto final (B41) también suma B14 + B33【22†】, lo que termina incluyendo a las Entidades solo una vez, sin duplicarlas. En términos de números, todo cuadra; pero la jerarquía presentada puede prestarse a confusión: Gobierno General (3.1.1) aparece igual a Gobierno Municipal (3.1.1.1.0), y las Entidades (3.1.1.2.0) están listadas pero aparentemente no aportan a Gobierno General salvo a través de Gobierno Municipal. Esto parece un error o una solución de último momento. Quizá la intención era no contar dos veces a las entidades, pero a costa de colocar su suma dentro de la fila del gobierno municipal. Desde el punto de vista de calidad, sería más lógico que B12 (Gobierno General) fuera =B13 + B33 y B13 (Gobierno Municipal) solo =B14 (Órgano Ejecutivo), dejando que luego Total del Gasto sume B12 (lo cual incluiría entidades ya). La manera actual es funcionalmente correcta pero conceptualmente confusa. Es un área donde la consistencia jerárquica puede mejorarse para evitar malentendidos.
Redondeo y decimales: Los números manejados tienen decimales, algunos hasta 2 decimales (centavos) y otros con más (por ejemplo, vimos -0.26 en un caso, o .8300003 en otros). Esto sugiere que los datos se manejan con decimales de centavos. Excel presenta muchos de ellos con notación científica en las extracciones (debido a binarios), pero seguramente en la hoja están formateados con dos decimales o quizás sin decimales (si son pesos enteros). No notamos inconsistencias de redondeo evidentes; es decir, no hay sumas que difieran por centavos entre la izquierda y derecha, lo cual indica que todos los campos se calculan de la misma manera (por ejemplo, no hay un redondeo de más en la pivot que cause un peso de diferencia). Esto es bueno: la suma de devengado por dependencia da exactamente el devengado total.
Un ejemplo: Devengado total en varias hojas es 6,085,911,765.80 y al sumar manualmente cada dependencia listada da el mismo resultado (los pequeños .01 o .05 en algunas dependencias, suman correctamente sin exceder). Por tanto, no se observan problemas de errores acumulados por decimales.
Duplicación de valores: Salvo la duplicidad de la hoja entera mencionada, dentro de las hojas no hay duplicación inapropiada de datos. Cada dependencia o partida aparece una vez. En la Clasificación Administrativa, podría parecer que la sección izquierda y derecha “duplican” los mismos números, pero eso es intencional para propósitos de verificación. No es un error de duplicado en el dataset, sino la misma información vista dos veces. No hay, por ejemplo, dos filas del mismo código en ninguna de las clasificaciones. Tampoco hay fórmulas contando dos veces un mismo elemento, ya que todas las sumas de totales eligen los rangos correctos sin traslapar.
Celdas con referencias circulares o fórmulas inertes: No se detectaron referencias circulares (la cadena B10 = B11, B11 = B12, ... eventualmente B33 = B… no formó un círculo completo porque la última referencia apunta a una celda con valor base, no de vuelta a B10). Las fórmulas del tipo referencia a la siguiente fila son poco comunes pero no causan loop a menos que se hiciera inadvertidamente un ciclo, lo cual no ocurrió. Todas las fórmulas calculan algo válido. Asimismo, no hay macros ni transformaciones especiales; todo son fórmulas estándares, lo que reduce posibles errores de ejecución.
Presentación y claridad de datos: Aunque es más un tema de diseño, incide en la calidad percibida. El informe mezcla en la misma hoja dos presentaciones (la jerárquica y la pivot estática). Visualmente esto está manejado mediante columnas en blanco separadoras y probablemente con colores o tipos de letra distintos (no podemos ver estilos desde la extracción, pero asumimos que los encabezados y totales están resaltados). No obstante, en algunas hojas como Programática, la gran cantidad de filas de categorías vacías (códigos sin asignación) hace el reporte extenso, quizás más de lo necesario para el lector. Desde un punto de vista de calidad de información, todas las categorías relevantes están incluidas, pero tal vez la abundancia de filas 0 puede distraer. Esto ya es una decisión de completitud vs concisión. El archivo optó por completitud.
En suma, la información numérica es consistente y de buena calidad, respaldada por fórmulas que se equilibran entre sí. Se apreciaron, eso sí, detalles mejorables en la documentación dentro del archivo: textos no actualizados, un duplicado de hoja obsoleto, y algunos pequeños descuidos de formato. No hay indicios de errores de cálculo o datos incorrectos, pero sí algunos de presentación que podrían corregirse para evitar confusiones.
5. Patrones observados, errores recurrentes y áreas de mejora en el manejo de los datos
A partir del análisis detallado, emergen varios patrones en cómo se manejan los datos en este archivo, así como oportunidades de mejora para futuros trabajos similares:
Uso sistemático de plantillas copiadas: Es evidente que el archivo se construyó probablemente tomando como base una plantilla de periodos anteriores (por ejemplo, la hoja Programático de 2022) y actualizando los datos para 2024. El patrón de nombrado de hojas y la repetición de fórmulas es consistente en todas, lo que sugiere un reuso deliberado de estructura. Este enfoque ahorra tiempo, pero conlleva el riesgo de arrastrar información desactualizada (como ocurrió con la fecha no cambiada y la hoja duplicada). Área de mejora: implementar listas de verificación al actualizar la plantilla (asegurarse de ajustar todas las referencias temporales y eliminar hojas sobrantes) o incluso vincular la portada y notas a celdas de parámetro (por ejemplo, tener una celda con "Hasta septiembre 2024" y referenciarla donde corresponda) para no depender de editar manualmente cada texto.
Doble representación de los datos (jerarquía vs pivot) como control: Un patrón muy claro es esta duplicación de datos en cada hoja: los valores se presentan en la estructura de clasificación y simultáneamente en una tabla plana por la misma dimensión. Esto actúa como un mecanismo de validación cruzada. El autor verifica que ambas representaciones den los mismos totales, minimizando errores. Este patrón es potente para asegurar confiabilidad, pero puede volver el archivo más pesado de mantener (cada cambio de dato debe reflejarse en ambas partes, o en su defecto actualizar la pivot y las fórmulas). En el archivo actual, al parecer alimentaban la pivot de una fuente, y las fórmulas arrastraban esos resultados a la izquierda. Área de mejora: Si el informe es estático (como un PDF para presentar), esta duplicación está bien ya que no se recalculará. Pero si se quisiera un archivo dinámico, habría formas más eficientes. Por ejemplo, se podría tener la base de datos en una hoja oculta y usar fórmulas del tipo SUMAR.SI.CONJUNTO para llenar directamente las tablas de cada clasificación, en lugar de pegar una pivot y luego fórmulas de verificación. Esto evitaría tener dos copias de números en cada hoja, reduciendo riesgo de discrepancia. Alternativamente, mantener las pivots actualizables dentro del archivo y usar GETPIVOTDATA para jalar los totales a las secciones de encabezados. Actualmente, al estar los valores pegados, hay duplicación "manual" que podría conllevar error si alguien edita un lado y olvida el otro. Afortunadamente parece que siempre derivan de la misma fuente. A futuro, conectar las partes mediante referencias (p.ej. que la columna B-F de la izquierda traiga los valores directamente de la tabla dinámica de la derecha con fórmulas GETPIVOTDATA) podría automatizar por completo la consistencia.
Calidad de documentación dentro del archivo: Observamos que la hoja NOTAS está creada para explicar el contenido pero no brinda explicaciones adicionales (solo enlista las clasificaciones). Esto sugiere que el informe carece de contexto o análisis cualitativo de las cifras, limitándose a lo cuantitativo. Área de mejora: aprovechar la hoja de Notas para incluir análisis de resultados, definiciones de términos (por ejemplo, explicar qué se considera Devengado contable, o qué implica Subejercicio), o resaltar alguna observación (subejercicios elevados en ciertas áreas, etc.). Esto convertiría el documento en algo más útil para terceros. Igualmente, corregir la Portada para incluir el nombre de la entidad responsable (Tesorería Municipal aparece, pero podría añadirse Unidad de Contabilidad, fecha de elaboración, etc.) mejoraría la profesionalidad del informe.
Consistencia de formato y nombres: Un error recurrente, aunque menor, es la inconsistencia en detalles de formato (como el mencionado uso accidental de minúscula, espacios extra, etc.). Son detalles fáciles de corregir, que no afectan los números pero sí la presentación. Patrón a cuidar: revisar nombres de cada categoría según nomenclatura oficial (por ejemplo, asegurarse de usar las mayúsculas correctas en acrónimos, tildes donde corresponda – notamos que en "Sria de Admón. y Tecnologías..." abreviaron Secretaría, tal vez por espacio, pero convendría unificar criterios de abreviaturas). Recomendación: Establecer un estándar y aplicarlo uniformemente: si se usarán códigos concatenados con nombres, decidir un estilo (a veces hay un espacio tras el código y luego el guión, en otras no; en "302 OFICINA DE LA PRESIDENCIA" hay doble espacio tras el código). Uniformar esto evitará percepciones de descuido. De igual forma, eliminar hojas o celdas residuales de versiones previas (la Programático duplicada, y cualquier rango definido que haya quedado oculto, etc.) mejora la limpieza del archivo.
Uso de títulos y subtotales explícitos vs propiedades de pivots: Un patrón notable es que en lugar de aprovechar las funcionalidades de subtotales dentro de la pivot, el autor decidió controlar los subtotales manualmente en la parte izquierda. Por ejemplo, agrupando letras programáticas bajo encabezados como "Desempeño de las Funciones" y calculando la suma con fórmulas. Excel pivot podría agrupar por otro campo o usar la jerarquía para mostrar totales parciales automáticamente. Parece que optaron por no hacerlo, quizá porque la clasificación programática no está en la base de datos con ese nivel de jerarquía (podría ser solo el código de letra). Entonces manualmente replicaron la jerarquía. Área de mejora: Si fuera posible enriquecer la base de datos con campos adicionales (p.ej. un campo "Grupo Programático" que diga "Desempeño de las Funciones" para E, B, P, F, G, A, R, K, etc.), la pivot podría mostrar esos grupos sin necesidad de montarlos a mano. Lo mismo aplica para Administrativa (campo de Órgano para agrupar dependencias), Funcional (finalidad), Objeto del Gasto (capítulo), etc. Incorporar más jerarquía en la pivot evitaría algunas celdas fórmula y reduciría riesgo de error manual al agrupar. No obstante, hacer esto requiere controlar bien la fuente de datos.
Identificación de errores potenciales repetidos: El único error claro que identificamos (hoja duplicada no actualizada) parece ser aislado a esa instancia, no es algo repetido en otras hojas. Dentro de las hojas, la confusión jerárquica de Gobierno Municipal vs Entidades podría considerarse un error de categorización. Si esto provino de copiar la metodología de otro municipio o de un instructivo, quizá valga la pena revisar las guías de CONAC para representar Gobierno General. Posiblemente un error similar podría repetirse en otros informes si no se atiende: siempre verificar que la suma padre-hijo refleje la estructura real. En este caso integraron los entes descentralizados en el padre en vez de en el abuelo, por así decir. Es un patrón de “parche” que ojalá no se repita en otras clasificaciones (no vimos otro caso igual, dado que en las demás los niveles parecen sumarse correctamente).
Mantenimiento del archivo y actualización de datos: Dado que las cifras parecen ser finales a septiembre 2024, cabe preguntarse cómo actualizarán esto en diciembre o para otro año. El patrón actual requiere reemplazar los datos base y refrescar las pivot o re-pegar nuevos valores. Es un proceso manual que puede ser propenso a error. Área de mejora: Crear una macro o utilizar Power Query para alimentar todas las hojas desde una única fuente podría simplificar futuras actualizaciones. También, en lugar de mantener dos hojas Programático, al hacer una nueva versión anual tal vez conviene archivar el libro aparte en vez de mantener hojas históricas mezcladas. Esto evitaría olvidar retirar partes antiguas.
Claridad en el desglose de subejercicio: Notamos que calculan subejercicio y lo muestran, pero no todos los informes lo hacen. Es un buen hábito porque inmediatamente se ve cuánto no se ha ejercido del modificado. Un patrón positivo: subejercicio significativo en ciertas áreas – por ejemplo, en Objeto del Gasto, capítulo 6000 (Bienes muebles, inmuebles e intangibles) probablemente tenía un subejercicio notable (vimos 248 millones en G60). En Programático, la categoría E tenía ~7.96e8 (796 millones) de subejercicio, R ~344 millones, G ~52 millones, etc. Estas cifras saltan a la vista. Uso potencial de esta info: destacar en notas o conclusiones dónde están los mayores subejercicios podría ser una mejora en análisis. Actualmente, el archivo deja esos números para que el lector los calcule mentalmente o los deduzca; una mejora cualitativa sería señalar patrones: por ejemplo, "Se observa que el mayor subejercicio se concentra en Prestación de Servicios Públicos (letra E) y Proyectos de Inversión (K, sin recursos ejecutados), lo que sugiere retrasos en inversión física." – Este tipo de conclusiones agregaría valor al documento. Aunque esto va más allá de datos brutos, es una recomendación de manejo de información.
Verificación cruzada entre hojas: Una mejora adicional de control de calidad sería agregar en NOTAS o en una hoja resumen una pequeña tabla comparativa de los Totales por clasificación para evidenciar que todos cuadran. Algo como:
nginx
Copiar
Editar
Total Egresos Devengados:
- Admva: $6,085,911,765.80
- Objeto: $6,085,911,765.80
- Económica: $6,085,911,765.80
... etc.
Aunque redundante, sirve como check final. Actualmente eso se hace indirectamente con las fórmulas, pero no está expuesto al lector casual.
En conclusión, los patrones de construcción del archivo muestran un énfasis en la fiabilidad de los datos a través de redundancia calculada (lo cual es bueno para evitar errores numéricos) y un reuso de estructuras predefinidas. Las principales áreas de mejora se centran en la limpieza y documentación del archivo: eliminar hojas antiguas o datos desactualizados, uniformizar formatos y títulos, y proporcionar contexto. En cuanto al manejo de datos, podrían incorporarse métodos más automáticos de actualización para reducir esfuerzos manuales repetitivos. También, si el informe es para terceros, añadir interpretación de los datos (aunque esto último ya trasciende el "manejo" para entrar al análisis financiero). En términos de integridad de datos y estructura, con pequeños ajustes (como corregir esas fórmulas jerárquicas atípicas en Admva o facilitando las jerarquías en las dinámicas), el archivo estaría muy sólido. En síntesis, estamos ante un archivo bien organizado en lo numérico, con prácticas de control interno (doble chequeo) claras, y cuya principal debilidad está en detalles accesorios fácilmente corregibles. Al pulir esos detalles, el informe será más confiable y profesional tanto en contenido como en presentación.

"""

# Guardar el audio en un archivo
audio_file_path = "./reporte010425.mp3"
engine.save_to_file(texto_audio, audio_file_path)
engine.runAndWait()

# Devolver la ruta del archivo de audio generado
audio_file_path
