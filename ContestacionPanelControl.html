<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Respuesta Panel Control</title>
    <link rel="shortcut icon" href="./assets/images/lg_seccion.jpg" type="image/x-icon">
    <script src="./assets/js/SesionUser.js"></script>
    <script src="./assets/js/MenuContenido.js"></script>
    <script src="./assets/js/MenuSistema.js"></script>

    <script type="module" src="./assets/js/Contestacion.js"></script>

    <!-- Bootstrap 5 (CSS + Bundle con Popper) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery (necesario para DataTables) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <!-- QRCode Generator -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <!-- Descarga de EXCEL -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <!-- Estilos Personalizados  lugar si importa-->
    <link rel="stylesheet" href="./assets/css/TesoreriaStyle.css">
    <!-- Estilos de Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
    <header>
        <img src="./assets/images/lg_banner.jpg" alt="Logo" class="logo" style="width: 30%; height: 50%;">
        <h1>Sistema Institucional</h1>
    </header>

    <nav class="navbar navbar-expand-lg">
    </nav>

    <main>
        <h1 class="mb-4">Listado de Respuestas</h1>

        <div>
            <h2 class="titulo-filtros"><i class="fas fa-filter"></i> Filtrar Respuestas</h2>
            <div class="row g-3" hidden>
                <!--ID_RegistroOficios-->
                <div class="col-md-6">
                    <label for="ID_RegistroOficios">ID_RegistroOficios</label>
                    <input type="text" id="ID_RegistroOficios" name="ID_RegistroOficios" class="form-control">
                </div>
                <!--TipoOficio-->
                <div class="col-md-6">
                    <label for="TipoOficio">Tipo de Oficio</label>
                    <select class="form-select" id="TipoOficio" name="TipoOficio">
                        <option value="Todos">Todos</option>
                        <option value="Regularizacion">Regularización</option>
                        <option value="Suficiencia_Presupuestal">Suficiencia Presupuestal</option>
                        <option value="Suficiencia_Compromiso_Gasto">Suficiencia Compromiso Gasto</option>
                        <option value="Suficiencia_Anticipada">Suficiencia Anticipada</option>
                        <option value="Modificaciones_Suficiencia_Presupuestal">Modificaciones Suficiencia Presupuestal
                        </option>
                        <option value="Ampliacion_de_suficiencia">Ampliación de suficiencia</option>
                        <option value="Oficio">Oficio</option>
                        <option value="Memorando">Memorando</option>
                        <option value="Circular">Circular</option>
                        <option value="Recalendarizacion">Recalendarización</option>
                        <option value="Transferencia">Transferencia</option>
                        <option value="Uso_de_partida">Uso de partida</option>
                        <option value="Lic_Romay">Lic. Romay</option>
                        <option value="Ampliacion_Presupuestal">Ampliación Presupuestal</option>
                        <option value="Ampliacion_Liquida">Ampliación Líquida</option>
                        <option value="Reasignacion">Reasignación</option>
                        <option value="Disposicion_y_Reasignacion">Disposición y Reasignación</option>
                        <option value="Disposicion">Disposición</option>
                        <option value="Apertura_de_Fondo_Fijo">Apertura de Fondo Fijo</option>
                        <option value="Multianuales">Multianuales</option>
                        <option value="Transparencia">Transparencia</option>
                        <option value="Reduccion">Reducción</option>
                    </select>
                </div>
                <!--NumeroOficio-->
                <div class="col-md-6">
                    <label for="NumeroOficio">Número de Oficio</label>
                    <input type="text" id="NumeroOficio" name="NumeroOficio" class="form-control">
                </div>
                <!--FechaRetroactivo-->
                <div class="col-md-6">
                    <label for="FechaRetroactivo">Fecha Retroactivo</label>
                    <input type="date" id="FechaRetroactivo" name="FechaRetroactivo" class="form-control">
                </div>
                <!--DirigidoA-->
                <div class="col-md-6">
                    <label for="DirigidoA">Dirigido A</label>
                    <input type="text" id="DirigidoA" name="DirigidoA" class="form-control">
                </div>
                <!--Asunto-->
                <div class="col-md-6">
                    <label for="Asunto">Asunto</label>
                    <input type="text" id="Asunto" name="Asunto" class="form-control">
                </div>
                <!--Institucion-->
                <div class="col-md-6">
                    <label for="Institucion">Institución</label>
                    <select class="form-select" id="Institucion" name="Institucion">
                        <option value="Todos">Todos</option>
                        <!-- Dependencias -->
                        <option value="Coordinación de las Regidurías">Coordinación de las Regidurías</option>
                        <option value="Presidencia Municipal">Presidencia Municipal</option>
                        <option value="Sindicatura Municipal">Sindicatura Municipal</option>
                        <option value="Secretaría del Ayuntamiento">Secretaría del Ayuntamiento</option>
                        <option value="Contraloría Municipal">Contraloría Municipal</option>
                        <option value="Tesorería Municipal">Tesorería Municipal</option>
                        <option value="Secretaría General de Gobierno">Secretaría General de Gobierno</option>
                        <option value="Secretaría de Bienestar y Participación Ciudadana">Secretaría de Bienestar y
                            Participación Ciudadana</option>
                        <option value="Secretaría para la Igualdad Sustantiva de Género">Secretaría para la Igualdad
                            Sustantiva de Género</option>
                        <option value="Secretaría de Administración y Tecnologías de la Información">Secretaría de
                            Administración y Tecnologías de la Información</option>
                        <option value="Secretaría de Gestión y Desarrollo Urbano">Secretaría de Gestión y Desarrollo
                            Urbano</option>
                        <option value="Gerencia del Centro Histórico y Patrimonio Cultural">Gerencia del Centro
                            Histórico y Patrimonio Cultural</option>
                        <option value="Secretaría de Economía y Turismo">Secretaría de Economía y Turismo</option>
                        <option value="Secretaría de Movilidad e Infraestructura">Secretaría de Movilidad e
                            Infraestructura</option>
                        <option value="Secretaría de Seguridad Ciudadana">Secretaría de Seguridad Ciudadana</option>
                        <option value="Secretaría de Servicios Públicos">Secretaría de Servicios Públicos</option>
                        <option value="Secretaría de Medio Ambiente">Secretaría de Medio Ambiente</option>
                        <option value="Coordinación General de Transparencia y Municipio Abierto">Coordinación General
                            de Transparencia y Municipio Abierto</option>
                        <option value="Coordinación General de Comunicación Social">Coordinación General de Comunicación
                            Social</option>
                        <option value="Dirección General de Desarrollo y Formación Profesional">Dirección General de
                            Desarrollo y Formación Profesional</option>

                        <!-- Organismos -->
                        <option value="Sistema Municipal DIF">Sistema Municipal DIF</option>
                        <option value="Instituto Municipal del Deporte de Puebla">Instituto Municipal del Deporte de
                            Puebla</option>
                        <option value="Instituto de la Juventud del Municipio de Puebla">Instituto de la Juventud del
                            Municipio de Puebla</option>
                        <option value="Instituto Municipal de Arte y Cultura de Puebla">Instituto Municipal de Arte y
                            Cultura de Puebla</option>
                        <option value="Organismo Operador del Servicio de Limpia del Municipio de Puebla">Organismo
                            Operador del Servicio de Limpia del Municipio de Puebla</option>
                        <option value="Industrial de Abastos de Puebla">Industrial de Abastos de Puebla</option>
                        <option value="Instituto Municipal de Planeación">Instituto Municipal de Planeación</option>

                        <!--Estatales-->
                        <option value="Secretaría de Planeación, Finanzas y Administración">Secretaría de Planeación,
                            Finanzas y Administración</option>
                    </select>
                </div>
                <!--Solicita-->
                <div class="col-md-6">
                    <label for="Solicita">Solicita</label>
                    <select class="form-select" id="Solicita" name="Solicita">
                        <option value="Todos">Todos</option>
                        <option value="36">Leobardo Armenta Suárez</option>
                        <option value="39">Gloria Dolores Rodríguez Medina</option>
                        <option value="35">Eugenia Bermejo García</option>
                        <option value="29">Laura Hernandez Garcia</option>
                        <option value="24">Alan Michell Navarrete Flores</option>
                        <option value="41">José Gilberto Bello Ramírez</option>
                        <option value="4">Juan Carlos García Tagle</option>
                        <option value="8">Isabel Cristina Pavón Nava</option>
                        <option value="11">Isabel Cortes Varillas</option>
                        <option value="20">Maria Isabel Marín León</option>
                        <option value="21">Ariosto Emilio Lechuga Aparicio</option>
                        <option value="22">Gonzalo Ochoa Huerta</option>
                        <option value="23">Laura Alatriste Torres</option>
                        <option value="5">Maria Blanca Soriano Rojas</option>
                        <option value="1">Agustín Arenas Martinez</option>
                        <option value="17">Maria Del Carmen Damian Aguilar</option>
                        <option value="10">Maria De Lourdes Molina Quiroz</option>
                        <option value="7">Maria De Lourdes Gutierrez Castañeda</option>
                        <option value="16">Maria Valeria Corro Stefanoni</option>
                        <option value="12">Ariadna Michel Sánchez Rodríguez</option>
                        <option value="13">Michelle Córdova Torres</option>
                        <option value="19">Francisco Javier Rivera Castillo</option>
                        <option value="15">Antonio Castañon Ruiz</option>
                        <option value="18">Ofelia Olguin Aguilar</option>
                        <option value="6">Xochil Cuatepitzi Torres</option>
                        <option value="14">Daniel Rodríguez Cardenas</option>
                        <option value="9">Roberta Marcela Uvera Saucedo</option>
                        <option value="42">Elisa Castillo Ramírez</option>
                        <option value="44">Cèsar Andrès Marìn Àlvarez</option>
                        <option value="31">Sonia Pavon Nava</option>
                        <option value="32">Yamil Méndez Valdez</option>
                        <option value="27">Gisela González Martínez</option>
                        <option value="25">Alejandra Rojas Hernández</option>
                        <option value="26">Arnulfo Sánchez Mora</option>
                        <option value="37">Dora Maria Torres Herrera</option>
                        <option value="42">Ricardo Altamirano Santana</option>
                        <option value="48">Erika Lopez Zepeda</option>
                        <option value="49">Luis Enrique Silva Santiago</option>
<option value="46">Nahim Nava Ortiz</option>
                    </select>
                </div>
                <!--FolioInterno-->
                <div class="col-md-6">
                    <label for="FolioInterno">Folio Interno</label>
                    <input type="text" id="FolioInterno" name="FolioInterno" class="form-control">
                </div>
                <!--Estado-->
                <div class="col-md-6">
                    <label for="Estado">Estado</label>
                    <select class="form-select" id="Estado" name="Estado">
                        <option value="Todos">Todos</option>
                        <option value="Registrado">Registrado</option>
                        <option value="Turnado">Turnado</option>
                        <option value="Acuse de recibo">Acuse de recibo</option>
                        <option value="Archivado">Archivado</option>
                        <option value="Rechazado">Rechazado</option>
                        <option value="Cancelado">Cancelado</option>
                    </select>
                </div>
                <!--FechaEntregaDGAnalista-->
                <div class="col-md-6">
                    <label for="FechaEntregaDGAnalista">Fecha Entrega DG Analista</label>
                    <input type="date" id="FechaEntregaDGAnalista" name="FechaEntregaDGAnalista" class="form-control">
                </div>
                <!--Concepto-->
                <div class="col-md-6">
                    <label for="Concepto">Concepto</label>
                    <input type="text" id="Concepto" name="Concepto" class="form-control">
                </div>
                <!--RespuestaA-->
                <div class="col-md-6">
                    <label for="RespuestaA">Respuesta A</label>
                    <input type="text" id="RespuestaA" name="RespuestaA" class="form-control">
                </div>
                <!--Monto-->
                <div class="col-md-6">
                    <label for="Monto">Monto</label>
                    <input type="number" step="0.01" id="Monto" name="Monto" class="form-control">
                </div>
                <!--FechaRecepcionDependencia-->
                <div class="col-md-6">
                    <label for="FechaRecepcionDependencia">Fecha Recepción Dependencia</label>
                    <input type="date" id="FechaRecepcionDependencia" name="FechaRecepcionDependencia"
                        class="form-control">
                </div>
                <!--FechaEntregaAnalistaOperador-->
                <div class="col-md-6">
                    <label for="FechaEntregaAnalistaOperador">Fecha Entrega Analista/Operador</label>
                    <input type="date" id="FechaEntregaAnalistaOperador" name="FechaEntregaAnalistaOperador"
                        class="form-control">
                </div>
                <!--Comentario-->
                <div class="col-md-6">
                    <label for="Comentario">Comentario</label>
                    <input type="text" id="Comentario" name="Comentario" class="form-control">
                </div>
                <!--ArchivoAdjunto-->
                <div class="col-md-6">
                    <label for="ArchivoAdjunto">Archivo Adjunto</label>
                    <input type="text" id="ArchivoAdjunto" name="ArchivoAdjunto" class="form-control">
                </div>
                <!--UsuarioRegistro-->
                <div class="col-md-6">
                    <label for="UsuarioRegistro">Usuario Registro</label>
                    <select class="form-select" id="UsuarioRegistro" name="UsuarioRegistro">
                        <option value="Todos">Todos</option>
                        <option value="39">Gloria Dolores Rodríguez Medina</option>
                        <option value="35">Eugenia Bermejo García</option>
                    </select>
                </div>
                <!--FechaRegistro-->
                <div class="col-md-6">
                    <label for="FechaRegistro">Fecha Registro</label>
                    <input type="date" id="FechaRegistro" name="FechaRegistro" class="form-control">
                </div>
                <!--FechaActualizacion-->
                <div class="col-md-6">
                    <label for="FechaActualizacion">Fecha Actualización</label>
                    <input type="date" id="FechaActualizacion" name="FechaActualizacion" class="form-control">
                </div>
                <!--FechaLimitePago-->
                <div class="col-md-6">
                    <label for="FechaLimitePago">Fecha Límite de Pago</label>
                    <input type="date" id="FechaLimitePago" name="FechaLimitePago" class="form-control">
                </div>
            </div>

            <div class="col-12 d-flex justify-content-between">
                <button class="btn btn-primary toggleButton" id="btn-filtrar"><i class="fas fa-search"></i> Aplicar
                    Filtros</button>
                <button class="btn btn-primary toggleButton" id="btn-mostrar-ocultar"><i class="fa-solid fa-eye"
                        title="Mostrar/Ocultar"></i></button>
                <button class="btn btn-primary toggleButton" id="btn-limpiar"><i class="fas fa-undo"></i> Limpiar
                    Filtros</button>
            </div>
        </div>

        <div class="table-responsive">
            <div class="col-12 d-flex justify-content-between">
                <button id="crearContestacion" class="btn btn-primary toggleButton">Nuevo Registro</button>
                <button id="descargarExcelOficios" class="btn btn-primary toggleButton">Descargar Excel</button>
            </div>
            <table id="tableContestaciones" class="table table-bordered table-hover display nowrap"
                style="width:100%; table-layout: auto;">
                <thead>
                    <tr>
                        <th>Acciones</th>
                        <th>ID_RegistroOficios</th>
                        <th>FechaRegistro</th>
                        <th>TipoOficio</th>
                        <th>NumeroOficio</th>
                        <th>FechaRetroactivo</th>
                        <th>DirigidoA</th>
                        <th>Asunto</th>
                        <th>Institucion</th>
                        <th>Solicita</th>
                        <th>FolioInterno</th>
                        <th>Estado</th>
                        <th>FechaEntregaDGAnalista</th>
                        <th>Concepto</th>
                        <th>RespuestaA</th>
                        <th>Monto</th>
                        <th>FechaRecepcionDependencia</th>
                        <th>FechaEntregaAnalistaOperador</th>
                        <th>UsuarioRegistro</th>
                        <th>FechaActualizacion</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Filas generadas dinámicamente -->
                </tbody>
            </table>
        </div>
    </main>

    <!-- Modal para mostrar el comentario completo -->
    <div class="modal fade" id="comentarioModal" tabindex="-1" role="dialog" aria-labelledby="comentarioModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="comentarioModalLabel">Comentario Completo</h5>
                </div>
                <div class="modal-body">
                    <!-- El comentario completo se insertará aquí -->
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>© 2025 Sistema PagoTrack - Gestión de Pagos</p>
    </footer>
</body>

</html>