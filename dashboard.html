<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de control</title>
    <link rel="shortcut icon" href="./assets/images/lg_seccion.jpg" type="image/x-icon">
    <link rel="stylesheet" href="./assets/css/style.css">
    <script src="./assets/js/SesionUser.js"></script>
    <script src="./assets/js/dashboard.js"></script>
    <script src="./assets/js/MenuSistema.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <!-- Sección para el Inicio -->
                    <li id="Operador" style="display: none;" class="nav-item">
                        <a class='nav-link' href="dashboard.html">Inicio</a>
                    </li>
                    <!-- Sección para el Tramite -->
                    <li id="Tramite" class="nav-item dropdown" style="display: none;">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Trámite
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li id="Operador" style="display: none;"><a class="dropdown-item"
                                    href="dashboard.html">Inicio</a></li>
                            <li id="Operador" style="display: none;"><a class="dropdown-item"
                                    href="createTramite.html">Crear Trámite</a></li>
                            <li id="Analista" style="display: none;"><a class="dropdown-item"
                                    href="listadoTurnados.html">Listado de Turnados</a></li>
                            <li id="Operador" style="display: none;"><a class="dropdown-item"
                                    href="seguimientoOrdenesPago.html">Ordenes de Pago</a></li>
                            <li id="Operador" style="display: none;"><a class="dropdown-item"
                                    href="seguimientoRemesas.html">Remesas</a></li>
                        </ul>
                    </li>
                    <!-- Sección para el Ordenes de Pago -->
                    <li id="Pagos" class="nav-item dropdown" style="display: none;">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Ordenes de Pago
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li id="Pagos" style="display: none;"><a class="dropdown-item"
                                    href="seguimientoOrdenesPago.html">Ordenes de Pago</a></li>
                        </ul>
                    </li>
                    <!-- Sección para el KPI -->
                    <li id="KPI" class="nav-item dropdown" style="display: none;">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Indicadores de Rendimiento
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li id="KPI" style="display: none;"><a class="dropdown-item" href="kpi.html">KPI</a></li>
                            <li id="KPI" style="display: none;"><a class="dropdown-item"
                                    href="dashboard.html">Tramites</a></li>
                            <li id="KPI" style="display: none;"><a class="dropdown-item"
                                    href="listadoTurnados.html">Turnado</a></li>
                            <li id="KPI" style="display: none;"><a class="dropdown-item"
                                    href="seguimientoRemesas.html">Remesas</a></li>
                            <li id="KPI" style="display: none;"><a class="dropdown-item"
                                    href="seguimientoOrdenesPago.html">Ordenes de Pago</a></li>
                            <li id="KPI" style="display: none;"><a class="dropdown-item"
                                    href="reportesquery.html">Reportes Query</a></li>
                            <li id="KPI" style="display: none;"><a class="dropdown-item"
                                    href="exploradorArchivos.html">Explorador de Archivos</a></li>

                        </ul>
                    </li>
                    <!-- Sección para el Oficios -->
                    <li id="Oficios" class="nav-item dropdown" style="display: none;">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Correspondencia y Oficios
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li id="Oficios" style="display: none;"><a class="dropdown-item"
                                    href="OficiosPanelControl.html">Oficios</a></li>
                            <!-- <li id="Oficios" style="display: none;"><a class="dropdown-item"
                                    href="#">Correspondencia</a></li> -->
                        </ul>
                    </li>
                    <!-- Sección para el Manual --> 
                    <li><a class="nav-link" href="manual.html">Manual</a></li>
                    <!-- Sección para el Estados -->
                    <li><a class="nav-link" href="help.html">Estados</a></li>
                    <!-- Sección para el Cerrar sesión -->
                    <li><a class='nav-link' href="#" onclick='cerrarSesion(); window.location.href = "index.html";'>Cerrar Sesión</a></li>
                </ul>
            </div>
        </div>
    </nav>
    
    <h1>Panel de control</h1>

    <button id="generarResumen" class="btn btn-info" hidden>Generar Resumen Corporativo</button>
    <div id="resumenGPT" class="mt-3 p-3 border rounded bg-light" hidden></div>


    <div class="contenedor">
        <div class="table-container">
            <div>
                <h2 style="text-align: center;">Seguimiento de Trámites</h2>
                <table id="tramitesTable">
                    <thead>
                        <tr id="tableHead">
                            <th>Analista</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>

            <br> <br>
            <div class="filtros-container" >
                <h2 class="titulo-filtros"><i class="fas fa-filter"></i> Filtrar Trámites</h2>

                <div class="grid-filtros">
                    <!-- Columna Id -->
                    <div class="filtro-group">
                        <label for="ID_CONTRATO">Identificador Unico</label>
                        <input type="text" id="ID_CONTRATO" class="filtro-input">
                    </div>

                    <!-- Columna Estado -->
                    <div class="filtro-group">
                        <label for="estadoSelect">Estado</label>
                        <select name="estadoSelect" id="estadoSelect" class="filtro-select">
                            <option value="Todos">Todos</option>
                            <option value="Creado">Creado</option>
                            <option value="Turnado">Turnado</option>
                            <option value="Observaciones">Observaciones</option>
                            <option value="Devuelto">Devuelto</option>
                            <option value="JuntasAuxiliares">Juntas Auxiliares</option>
                            <option value="Inspectoria">Inspectorías</option>
                            <option value="RegistradoSAP">Registrado SAP</option>
                            <option value="Remesa">Remesa</option>
                            <option value="DevueltoOrdenesPago">Devuelto Ordenes de Pago</option>
                            <option value="Pagado">Pagado</option>
                            <option value="Cheque">Cheque</option>
                            <option value="Terminado">Terminado</option>
                            <option value="Rechazado">Rechazado</option>
                            <option value="Cancelado">Cancelado</option>
                        </select>
                    </div>

                    <!-- Columna Mes -->
                    <div class="filtro-group">
                        <label for="mesSelect">Mes</label>
                        <select name="mesSelect" id="mesSelect" class="filtro-select">
                            <option value="Todos">Todos</option>
                            <option value="Enero">Enero</option>
                            <option value="Febrero">Febrero</option>
                            <option value="Marzo">Marzo</option>
                            <option value="Abril">Abril</option>
                            <option value="Mayo">Mayo</option>
                            <option value="Junio">Junio</option>
                            <option value="Julio">Julio</option>
                            <option value="Agosto">Agosto</option>
                            <option value="Septiembre">Septiembre</option>
                            <option value="Octubre">Octubre</option>
                            <option value="Noviembre">Noviembre</option>
                            <option value="Diciembre">Diciembre</option>
                        </select>
                    </div>

                    <!-- Columna Tipo de Trámite -->
                    <div class="filtro-group">
                        <label for="tipoTramiteSelect">Tipo de Trámite</label>
                        <select name="tipoTramiteSelect" id="tipoTramiteSelect" class="filtro-select">
                            <option value="Todos">Todos</option>
                            <option value="OC">OC Ordenes Compromiso</option>
                            <option value="OP">OP Órdenes de Pago</option>
                            <option value="SRF">SRF Solicitud de Recurso Financieros</option>
                            <option value="CRF">CRF Comprobación de Recurso Financieros</option>
                            <option value="JA">Juntas Auxiliares</option>
                            <option value="IPS">Inspectorías</option>
                            <option value="OCO">Ordenes Compromiso Obras</option>
                            <option value="OPO">Ordenes Pago Obras</option>
                        </select>
                    </div>

                    <!-- Columna Analista -->
                    <div class="filtro-group">
                        <label for="analistaSelect">Analista</label>
                        <select name="analistaSelect" id="analistaSelect" class="filtro-select">
                            <option value="Todos">Todos</option>
                            <option value="4">Juan Carlos García Tagle</option>
                            <option value="22">Gonzalo Ochoa Huerta</option>
                            <option value="8">Isabel Cristina Pavón Nava</option>
                            <option value="11">Isabel Cortes Varillas</option>
                            <option value="20">Maria Isabel Marín León</option>
                            <option value="21">Ariosto Emilio Lechuga Aparicio</option>
                            <option value="23">Laura Alatriste Torres</option>
                            <option value="5">Maria Blanca Soriano Rojas</option>
                            <option value="1">Agustín Arenas Martinez</option>
                            <option value="17">Maria Del Carmen Damian Aguilar</option>
                            <option value="10">Maria De Lourdes Molina Quiroz</option>
                            <option value="7">Maria De Lourdes Gutierrez Castañeda</option>
                            <option value="16">Maria Valeria Corro Stefanoni</option>
                            <option value="12">Ariadna Michel Sánchez Rodríguez</option>
                            <option value="13">Michelle Córdova Torres</option>
                            <option value="19">Francisco Javier Rivera Castillo</option>
                            <option value="15">Antonio Castañon Ruiz</option>
                            <option value="18">Ofelia Olguin Aguilar</option>
                            <option value="6">Xochil Cuatepitzi Torres</option>
                            <option value="14">Daniel Rodríguez Cardenas</option>
                            <option value="9">Roberta Marcela Uvera Saucedo</option>
                        </select>
                    </div>

                    <!-- Columna Dependencia -->
                    <div class="filtro-group">
                        <label for="dependenciaSelect">Institución</label>
                        <select name="dependenciaSelect" id="dependenciaSelect" class="filtro-select">
                            <option value="Todos">Todos</option>
                            <option value="Coordinación de las Regidurias">Coordinación de las Regidurias</option>
                            <option value="Oficina de Presidencia">Oficina de Presidencia</option>
                            <option value="Sindicatura Municipal">Sindicatura Municipal</option>
                            <option value="Secretaría del Ayuntamiento">Secretaría del Ayuntamiento</option>
                            <option value="Tesorería Municipal">Tesorería Municipal</option>
                            <option value="Contraloría Municipal">Contraloría Municipal</option>
                            <option value="Secretaría General de Gobierno">Secretaría General de Gobierno</option>
                            <option value="Secretaría de Bienestar y Participación Ciudadana">Secretaría de Bienestar y
                                Participación Ciudadana</option>
                            <option value="Secretaría de Movilidad e Infraestructura">Secretaría de Movilidad e
                                Infraestructura
                            </option>
                            <option value="Secretaría de Gestión y Desarrollo Urbano">Secretaría de Gestión y Desarrollo
                                Urbano
                            </option>
                            <option value="Secretaría de Economía y Turismo">Secretaría de Economía y Turismo</option>
                            <option value="Secretaría de Administración y Tecnologías de la Información">Secretaría de
                                Administración y Tecnologías de la Información</option>
                            <option value="Secretaría de Seguridad Ciudadana">Secretaría de Seguridad Ciudadana</option>
                            <option value="Coordinación General de Transparencia y Municipio Abierto">Coordinación
                                General de
                                Transparencia y Municipio Abierto</option>
                            <option value="Sistemas Municipal DIF">Sistemas Municipal DIF</option>
                            <option value="Organismo Operador del Servicio de Limpia del Municipio de Puebla">Organismo
                                Operador
                                del
                                Servicio de Limpia del Municipio de Puebla</option>
                            <option value="Instituto Municipal de Arte y Cultura de Puebla">Instituto Municipal de Arte
                                y
                                Cultura de
                                Puebla</option>
                            <option value="Instituto Municipal de Planeación">Instituto Municipal de Planeación</option>
                            <option value="Instituto Municipal del Deporte de Puebla">Instituto Municipal del Deporte de
                                Puebla
                            </option>
                            <option value="Instituto de la Juventud del Municipio de Puebla">Instituto de la Juventud
                                del
                                Municipio
                                de Puebla</option>
                            <option value="Industrial de Abastos de Puebla">Industrial de Abastos de Puebla</option>
                            <option value="Coordinación General de Comunicación Social">Coordinación General de
                                Comunicación
                                Social
                            </option>
                            <option value="Secretaria para la Igualdad Sustantiva de Género">Secretaria para la Igualdad
                                Sustantiva
                                de Género</option>
                            <option value="Secretaría de Servicios Públicos">Secretaría de Servicios Públicos</option>
                            <option value="Secretaría de Medio Ambiente">Secretaría de Medio Ambiente</option>
                            <option value="Direccion General De Desarrollo y Formación Profesional">Direccion General De
                                Desarrollo
                                y Formación Profesional</option>
                            <option value="Gerencia del Centro Histórico y Patrimonio Cultural">Gerencia del Centro
                                Histórico y
                                Patrimonio Cultural</option>
                        </select>
                    </div>

                    <!-- Columna Proveedor -->
                    <div class="filtro-group">
                        <label for="proveedorSelect">Proveedor</label>
                        <input type="text" id="proveedorSelect" class="filtro-input">
                    </div>

                    <!-- Columna Concepto -->
                    <div class="filtro-group">
                        <label for="conceptoSelect">Concepto</label>
                        <input type="text" id="conceptoSelect" class="filtro-input">
                    </div>

                    <!-- Columna Importe -->
                    <div class="filtro-group">
                        <label for="importeSelect">Importe</label>
                        <input type="number" id="importeSelect" class="filtro-input">
                    </div>

                    <!-- Columna Remesa -->
                    <div class="filtro-group">
                        <label for="remesaSelect">Remesa</label>
                        <input type="text" id="remesaSelect" class="filtro-input">
                    </div>

                    <!-- Columna Integración SAP -->
                    <div class="filtro-group">
                        <label for="integracionSAPSelect">Integración SAP</label>
                        <input type="text" id="integracionSAPSelect" class="filtro-input">
                    </div>

                    <!-- Columna Documento SAP -->
                    <div class="filtro-group">
                        <label for="docSAPSelect">Doc SAP</label>
                        <input type="text" id="docSAPSelect" class="filtro-input">
                    </div>

                    <!-- Columna Número de Trámite -->
                    <div class="filtro-group">
                        <label for="numeroTramiteSelect">Número de Trámite</label>
                        <input type="text" id="numeroTramiteSelect" class="filtro-input">
                    </div>

                    <!-- Columna Fecha de Recepción -->
                    <div class="filtro-group">
                        <label for="fechaRecepcionSelect">Fecha Recepción</label>
                        <input type="date" id="fechaRecepcionSelect" class="filtro-date">
                    </div>

                    <!-- Columna Fecha de Vencimiento -->
                    <div class="filtro-group">
                        <label for="fechaVencimientoSelect">Fecha Vencimiento</label>
                        <input type="date" id="fechaVencimientoSelect" class="filtro-date">
                    </div>
                </div>

                <div class="acciones-filtros">
                    <button class="btn-filtrar" id="btn-filtrar"><i class="fas fa-search"></i> Aplicar Filtros</button>
                    <button class="btn-limpiar" id="btn-limpiar"><i class="fas fa-undo"></i> Limpiar Filtros</button>
                </div>
            </div>

            <style>
                .filtros-container {
                    background: #f8f9fa;
                    padding: 1.5rem;
                    border-radius: 10px;
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                    margin-bottom: 2rem;

                }

                .titulo-filtros {
                    color: #2c3e50;
                    margin-bottom: 1.5rem;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                }

                .grid-filtros {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 1rem;
                    margin-bottom: 1.5rem;
                }

                .filtro-group {
                    display: flex;
                    flex-direction: column;
                    gap: 0.5rem;
                }

                .filtro-group label {
                    font-weight: 600;
                    color: #4a5568;
                    font-size: 0.9rem;
                }

                .filtro-select,
                .filtro-date {
                    padding: 0.5rem 1rem;
                    border: 1px solid #e2e8f0;
                    border-radius: 6px;
                    background: white;
                    transition: all 0.3s ease;
                }

                .filtro-select:focus,
                .filtro-date:focus {
                    border-color: #4299e1;
                    box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
                    outline: none;
                }

                .acciones-filtros {
                    display: flex;
                    gap: 1rem;
                    justify-content: center;
                    margin-top: 1rem;
                }

                .btn-filtrar,
                .btn-limpiar {
                    padding: 0.6rem 1.5rem;
                    border: none;
                    border-radius: 6px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                    transition: all 0.3s ease;
                }

                .btn-filtrar {
                    background: #4299e1;
                    color: white;
                }

                .btn-filtrar:hover {
                    background: #3182ce;
                }

                .btn-limpiar {
                    background: #e53e3e;
                    color: white;
                }

                .btn-limpiar:hover {
                    background: #c53030;
                }

                .full-width {
                    grid-column: 1 / -1;
                }

                @media (max-width: 768px) {
                    .grid-filtros {
                        grid-template-columns: 1fr;
                    }

                    .acciones-filtros {
                        flex-direction: column;
                    }

                    .btn-filtrar,
                    .btn-limpiar {
                        width: 100%;
                        justify-content: center;
                    }
                }
            </style>

            <div>
                <h2 style="text-align: center;">Listado de Trámites</h2>
                <button id="downloadExcelTramites" class="btn btn-primary toggleButton">Descargar Excel</button>
                <table id="tableTramites" class="display">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Mes</th>
                            <th>Fecha de Recepcion</th>
                            <th>Fecha Limite Solvencia</th>
                            <th>TipoTramite</th>
                            <th>Institución</th>
                            <th>Proveedor</th>
                            <th>Concepto</th>
                            <th>Importe</th>
                            <th>AnalistaTurnado</th>
                            <th>Estatus</th>
                            <th>Fondo</th>
                            <th>Remesa</th>
                            <th>DocSAP</th>
                            <th>IntegraSAP</th>
                            <th>Numero de Trámite</th>
                            <th>Acciones</th>
                            <th>Comentarios</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Filas generadas dinámicamente -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal para mostrar el comentario completo -->
    <div class="modal fade" id="comentarioModal" tabindex="-1" role="dialog" aria-labelledby="comentarioModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="comentarioModalLabel">Comentario Completo</h5>
                    <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button> -->
                </div>
                <div class="modal-body">
                    <!-- El comentario completo se insertará aquí -->
                </div>
                <!-- <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                </div> -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>